% /*
%  * @Descripttion: 
%  * @version: 
%  * @Author: Ke Wang
%  * @Date: 2024-07-06 09:34:29
%  * @LastEditors: Ke Wang
%  * @LastEditTime: 2024-07-06 19:21:44
%  */
mpc.baseMVA = 100;		
%% bus data																		
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin	Pmax	Pmin			
mpc.bus = [  %% (Pd and Qd are for reference, and load power is shown below)																		
	1	2	0	0	0	0	1	1.05000000000000	0.999999999999999	230	1	1.1	0.9	2000	0			
	2	1	0	0	0	0	1	1.03281032665893	-0.583647141705036	230	1	1.1	0.9	500	0			
	3	1	0	0	0	0	1	1.02234275929398	-1.41712446831302	230	1	1.1	0.9	500	0			
	4	1	0	0	0	0	1	1.01587219394564	-2.29546702153801	230	1	1.1	0.9	500	0			
	5	1	0	0	0	0	1	1.00322687496341	-3.12715017662369	230	1	1.1	0.9	500	0			
	6	1	0	0	0	0	1	0.987963952891348	-4.21990737063525	230	1	1.1	0.9	500	0			
	7	1	0	0	0	0	1	1.00553061304068	-3.23704016691798	230	1	1.1	0.9	500	0			
	8	1	0	0	0	0	1	0.987504274773903	-4.25514836687740	230	1	1.1	0.9	500	0			
	9	3	0	0	0	0	1	1.05000000000000	-1.89699310043575	230	1	1.1	0.9	1500	0			
	10	2	0	0	0	0	1	1.05000000000000	-1.22569243814780	230	1	1.1	0.9	500	0			
	11	1	0	0	0	0	1	1.00412024382409	-2.58352109340641	230	1	1.1	0.9	500	0			
	12	1	0	0	0	0	1	0.994671498117181	-3.32777348982754	230	1	1.1	0.9	650	0			
	13	1	0	0	0	0	1	0.999818815711776	-3.02098781316980	230	1	1.1	0.9	500	0			
	14	1	0	0	0	0	1	1.03734880781526	-1.23098513900776	230	1	1.1	0.9	500	0			
	15	1	0	0	0	0	1	1.03126086915643	-0.977271050500901	230	1	1.1	0.9	500	0			
	16	1	0	0	0	0	1	1.03194474240816	-0.671032540253646	230	1	1.1	0.9	500	0			
	17	1	0	0	0	0	1	1.03165313162612	-0.690331228171748	230	1	1.1	0.9	500	0			
	18	1	0	0	0	0	1	1.03000759336129	-0.806211607379310	230	1	1.1	0.9	700	0			
	19	1	0	0	0	0	1	1.03155088733496	-0.710473706241255	230	1	1.1	0.9	500	0			
];	

%% branch data																		
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax					
mpc.branch = [  %% (r and x specified in ohms here)																		
	1	2	0.00370300000000000	0.0181010000000000	0	1000	1500	2000	0	0	1	-360	360					
	2	3	0.00688600000000000	0.0338820000000000	-0.0387930000000000	1000	1500	2000	0	0	1	-360	360					
	3	4	0.0179000000000000	0.0942000000000000	-0.0921500000000000	1000	1500	2000	0	0	1	-360	360					
	4	5	0.00730000000000000	0.0402570000000000	-0.0410000000000000	1000	1500	2000	0	0	1	-360	360					
	5	6	0.0143180000000000	0.0720270000000000	-0.108237000000000	1000	1500	2000	0	0	1	-360	360					
	5	7	0.0150290000000000	0.0601140000000000	-0.0365970000000000	1000	1500	2000	0	0	1	-360	360					
	7	8	0.0191000000000000	0.0859000000000000	-0.150900000000000	1000	1500	2000	0	0	1	-360	360					
	7	9	0.0186000000000000	0.0861000000000000	-0.164100000000000	1000	1500	2000	0	0	1	-360	360					
	4	10	0.0201960000000000	0.0807850000000000	-0.0612780000000000	1000	1500	2000	0	0	1	-360	360					
	1	11	0.0121000000000000	0.0918000000000000	-0.131500000000000	1000	1500	2000	0	0	1	-360	360					
	11	12	0.0146460000000000	0.0598950000000000	-0.0359570000000000	1000	1500	2000	0	0	1	-360	360					
	11	13	0.00415300000000000	0.0244830000000000	-0.0169640000000000	1000	1500	2000	0	0	1	-360	360					
	10	14	0.00898400000000000	0.0437190000000000	-0.0343100000000000	1000	1500	2000	0	0	1	-360	360					
	14	15	0.00600000000000000	0.0350000000000000	-0.0325000000000000	1000	1500	2000	0	0	1	-360	360					
	15	16	0.00450900000000000	0.0180340000000000	-0.00915000000000000	1000	1500	2000	0	0	1	-360	360					
	16	17	0.000250000000000000	0.00100000000000000	-0.0120000000000000	1000	1500	2000	0	0	1	-360	360					
	17	18	0.00250000000000000	0.0100000000000000	-0.0550000000000000	1000	1500	2000	0	0	1	-360	360					
	17	19	0.00384300000000000	0.0153730000000000	-0.0120420000000000	1000	1500	2000	0	0	1	-360	360					
	19	2	0.00275100000000000	0.0110050000000000	-0.00862000000000000	1000	1500	2000	0	0	1	-360	360					
	15	19	0.00860100000000000	0.0437190000000000	-0.0331840000000000	1000	1500	2000	0	0	1	-360	360					
	16	2	0.000475000000000000	0.00190000000000000	-0.00165000000000000	1000	1500	2000	0	0	1	-360	360					
];			

%% generator data(here, status=1 means this gen is a CHP unit, status=2 means this gen is a thermal unit)																		
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10
mpc.gen = [																		
	1	7.50314624400000	0	40000	-40000	1.05000000000000	100	1	40000	0	0	0	0	0	0	0	0	0
	9	50	0	40000	-40000	1.05000000000000	100	1	40000	0	0	0	0	0	0	0	0	0
	10	50	0	40000	-40000	1.05000000000000	100	1	40000	0	0	0	0	0	0	0	0	0
];	

[baseMVA,bus,gen,branch]=deal(mpc.baseMVA,mpc.bus,mpc.gen,mpc.branch);
n = length(bus(:,1));
slackbus = find(mpc.bus(:,2)==3); 
nslack = length(slackbus);
PVbus = find(mpc.bus(:,2)==2);
nPV = length(PVbus);
nPQ = n-nPV-nslack;

% node admittance matrix 
Y = Y_matrix(n,branch); 
G = real(Y);
B = imag(Y);
% disp('node admittance matrix:');disp(Y);